<!DOCTYPE html>
<html>

<head>
    <title>Socket example</title>
</head>

<body>
    <ul id='userlist'></ul>
    <input id='username'>
    <button id='join'>join</button>
    <input id='text'>
    <button id='send'>send</button>
    <ul id='chatlist'></ul>
</body>

<script src="/socket.io/socket.io.js"></script>
<!-- create connection from the client to the server -->
<script>
    const socket = io();
    var userlist = document.getElementById('userlist');
    var chatlist = document.getElementById('chatlist');
    var send = document.getElementById('send');
    var join = document.getElementById('join');
    var username = document.getElementById('username');
    var text = document.getElementById('text');

    //make the send disabled if user has not join in the chat
    send.disabled = true;

    //when click the send button, send the text to everyone in chat
    send.addEventListener('click', () => {
        var value = text.value;
        socket.emit('send-clicked', value);
        // when the text sent, clear the text input 
        text.value = '';
    });
    socket.on('send-clicked', (msg) => {
        var item = document.createElement('li');
        item.textContent = msg;
        chatlist.appendChild(item);
    });

    join.addEventListener('click', () => {
        var value = username.value;
        socket.emit('join-clicked', value);
        username.value = '';
        //make the send button able after user joins in the chat
        send.disabled = false;
    });
    socket.on('join-clicked', (msg) => {
        var item = document.createElement('li');
        item.textContent = msg;
        userlist.appendChild(item);
    });


</script>

</html>